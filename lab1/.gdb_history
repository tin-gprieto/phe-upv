b main
run
s
run
disas main
ni
ni
q
b main
layout asm
run
ni
s
runb
run
q
b main
run
q
b main
run
s
p &buffer
q
b main
run
s
p &buffer 
p BUFSIZE
p &BUFSIZE
info variables
b main
layout asm
run
s
ni
p $eip
p $buffer 
p &buffer
q
b
b main
run
s
p &buffer 
q
b main
run
s
p &buffer 
x\5wx 0xffffce0e
 
x/5wx 0xffffce0e
 
q
b main
run
s
p &buffer 
p $eip
p *eip
p &eip
p $(void *)eip
p $eip
p 0x804918c
x/4wx 0x804918c
x/1wx 0x804918c
p FFFFCE60
p 0xFFFFCE60
p 0xFFFFCF56
p 0xFFFFCF56
p &0xFFFFCF56
n
p &buffer
q
b main
run
s
p &buffer
q
q
b main
r
s
p $eip
p &buffer
p BUFSIZE
p $BUFSIZE
info locals
info variables
n
info proc mappings
p &buffer 
p $eip
backtrace
info frame
p &buffer
q
b main
r
s
i r eip
cyclic -l 0x804918c
info frame
p &buffer 
b main
run
s
info fram
info frame
p &buffer 
q
b main
run
p system
find xf7e00000, 0xf7f00000, "/bin/sh" 0xf7f56abc
find 0xf7e00000, 0xf7f00000, "/bin/sh" 0xf7f56abc
find 0xf7d00000, 0xf7f00000, "/bin/sh" 0xf7f56abc
find 0xf7d00000, 0xf7f00000, "/bin/sh"
find 0xf7e00000, 0xf7f00000, "/bin/sh"
p system
find 0xf7d00000, 0xf8f00000, "/bin/sh"
q
b main
run
p system
find 0xf7e00000, 0xf7f00000, "/bin/sh"
info proc mappings
find 0xf7d89000, 0xf7f15000, "/bin/sh"
find 0x08048000, 0xffffe000, "/bin/sh"
find 0xf7d89000, 0xf7f15000, "/bin/sh"
break main
run
info proc mappings
find 0xf7d89000, 0xf7f15000, "/bin/sh"
p system
find 0xf7fc9000, 0xf7fed000, "/bin/sh"
find 0xf7fc9000, 0xf7fed000, "/bin/bash"
find 0xf7d89000, 0xf7f15000, "/bin/bash"
call system("echo hola")
find 0xf7d89000, 0xf7f15000, "/bin/bash"
find 0xf7fc9000, 0xf7fed000, "/bin/sh"
find 0xf7fc9000, 0xf7fed000, cstring "/bin/sh"
find 0xf7fc9000, 0xf7fed000, cstring"/bin/sh"
find 0xf7fc9000, 0xf7fed000, "/bin/sh"
p system
find "/bin/sh"
shell cat /proc/1864/maps
get pid
p getpid()
p getpid
p &getpid
p *getpid
q
b main
r
info proc mappings
x/s 0xf7d89000+0x1c9e3c
x/s 0xf7d66000+0x1c9e3c
p system
q
b main
r
info proc mappings
q
b main 
run
p system 
q
b main
r
s
info frame
p &buffer
q
b main
r
s
p system
find 0xf7e00000, 0xf7f00000, "ls"
find 0xf7d7c000, 0xf7f9a000, "ls"
find 0xf7d7c000, 0xf7f9a000, "/bin/sh"
q
b main
r
p &system
find 0xf7d7c000, 0xf7f9a000, "bin/sh"
info frame
p &buffer
s
info frame
p &buffer 
q
b main
r
s
info frame
p &buffer
q
q
b main
r
p system
find 0xf7d7c000, 0xf7f9a000, "bin/sh"
find 0xf7d7c000, 0xf7f9a000, "bin/bash"
find 0xf7d7c000, 0xf7f9a000, "ls"
x/s 0xf7d66000+0x1c9e3c
find 0xf7d7c000, 0xf7f9a000, "/bin/bash"
x/s 0xf7d66000+0x1c9e3c
find 0xf7d7c000, 0xf7f9a000, "/bin/bash"
x/s 0xf7d66000+0x1c9e3c
find 0xf7d7c000, 0xf7f9a000, "/bin/sh"
q
b main
r
p system
find 0xf7d7c000, 0xf7f9a000, "ls"
q
b main
l
r
find 0xf7d7c000, 0xf7f9a000, "bin/sh"
q
b main
r
find 0xf7d7c000, 0xf7f9a000, "/bin/sh"
q
q
b main
r
s
n
p &buffer 
p system
find 0xf7d7c000, 0xf7f9a000, "/bin/sh"
find 0xf7d66000, 0xf7f9d000, "/bin/sh"
q
